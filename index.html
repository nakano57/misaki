<!DOCTYPE html>
<html lang="ja-jp">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
    <title>Blue Archive Resource Viewer</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <meta name="og:title" content="Blue Archive Misaki" />
    <meta property="og:url" content="https://respectz.github.io/blue-archive-spine/" />
    <meta name="keywords" content="bluearchive" />
    <meta name="description" content="Blue Archive Misaki" />

    <!-- Main CSS -->
    <link rel="stylesheet" href="css/style.css">

    <!-- PIXI -->
    <script src="js/pixi.js"></script>
    <script src="js/pixi-spine.js"></script>

    <!-- UIkit CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.9.2/dist/css/uikit.min.css" />

    <!-- UIkit JS -->
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.9.2/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.9.2/dist/js/uikit-icons.min.js"></script>

    <!-- Main -->
    <script src="js/main.js"></script>

    <!-- Utility -->
    <script src="js/utility.js"></script>

    <!-- Howler -->
    <script src="https://cdn.jsdelivr.net/npm/howler@2.2.3/dist/howler.min.js"></script>
</head>

<body>

    <!-- Main Canvas -->
    <div id="canvasWrapper">
        <canvas id="screen"></canvas>
    </div>

    <audio autoplay loop src="assets/audio/rain.mp3" type="audio/mp3">水が流れる音</audio>

    <!-- load it -->
    <script>
        async function main() {
            // Init models
            let dataModels = await fetch("./data/models.json").then(r => r.json())
            
            // On window resize
            window.onresize = function () {
                width = window.innerWidth;
                height = window.innerHeight;
            }

            // Start
            async function updateCanvas(width, height) {
                width = width ? width : window.innerWidth;
                height = height ? height : window.innerHeight;

                if (!app) {
                    audios = await fetch("./data/audio.json").then(r => r.json())
                    app = new PIXI.Application(
                        {
                            width: width,
                            height: height,
                            view: document.getElementById("screen")
                        }
                    );
                    app.renderer.autoResize = true;
                    app.stage.interactive = true;
                }
            }
            await updateCanvas(window.innerWidth, window.innerHeight)
            loadChar(dataModels[0]);
        }
        main()
    </script>
</body>
</html>